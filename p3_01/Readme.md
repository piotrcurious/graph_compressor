This version is very interesting and works
but sometimes it hangs for no reason (calculating something long time)
